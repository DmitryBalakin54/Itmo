## Music API

`restapi` `fastapi`

### Условие

Необходимо реализовать api для хранения информации о музыкальных треках по описанию ниже.
Для реализации необходимо использовать библиотеку [fastapi](https://github.com/tiangolo/fastapi).
[Документация](https://fastapi.tiangolo.com/tutorial/).

Если из описания api возникают противоречия, то в первую очередь стоит ориентироваться на тесты к api.

#### 1. Метод для регистрации
Url метода: `/api/v1/registration/register_user`.
HTTP method: POST.

Перед использованием api пользователь должен зарегистрироваться в системе и в ответ получить токен доступа.

Для регистрации необходимо сделать POST-запрос с json, содержащий поля:
1. name - имя пользователя. Обязательное поле, тип `str`.
2. age - возраст пользователя. Обязательное поле, тип `int`.

В ответ на это пользователь получает json вида `{"token": "user_token"}`.

Токен - это произвольная строчка длиной 40 символов.
Каждый запрос регистрации должен возвращать новый токен.

#### 2. Обязательность токена
После регистрации пользователь получит токен.
Все остальные методы api требуют наличие этого токена в запросах пользователя.
Токен передается в заголовке запроса x-token.

Если этого заголовка нет, то пользователь должен получить ответ со статусом 401 и содержимым `{"detail": "Missing token"}`.

Если пользователь передал несуществующий токен, то он должен получить ответ со статусом 401 и содержимым `{"detail": "Incorrect token"}`.

**Важно:** Валидация токена должна осуществляться до всех остальных проверок.

#### 3. Метод добавления информации о треке
Url метода: `/api/v1/tracks/add_track`.
HTTP method: POST.

Для добавления информации о треке необходимо сделать POST-запрос c json, содержащий поля:
1. name - название трека. Обязательное поле, тип `str`.
2. artist - название группы/имя исполнителя. Обязательное поле, тип `str`.
3. year - год выпукска трека. Необязательное поле, тип `int`.
4. genres - жанры трека. Необязательное поле, тип `List[str]`.

В ответ пользователь должен получить ответ со статусом 201 и id трека в формате: `{"track_id": 42}`.
id трека - это целое число. Нумерация начинается с 1 и идет по возрастанию.
То есть id первого добавленного трека - 1, второго - 2 и т.д.

Если одного из обязательных полей нет, то пользователь должен получить ответ со статусом 422 и содержимым `{"detail": "описание ошибки"}`.

#### 4. Метод удаления информации о треке
Url метода: `/api/v1/tracks/{track_id}`.
HTTP method: DELETE.

Для удаления информации необходимо сделать DELETE-запрос по урлу, содержащий id трека.
Если пользователь передал несуществующий id, то он должен получить ответ со статусом 404 и содержимым `{"detail": "Invalid track_id"}`.
Если удаление произошло успешно, то пользователь поулчет ответ со статусом 200 и содержимым `{"status": "track removed"}`.

#### 5. Метод просмотра основной информации о треке
Url метода: `/api/v1/tracks/{track_id}`.
HTTP method: GET.

Для получения основной информации о треке необходимо сделать GET-запрос по урлу, содержащий id трека.
Если пользователь передал несуществующий id, то он должен получить ответ со статусом 404 и содержимым `{"detail": "Invalid track_id"}`.
Если пользователь передал корректный id, то он должен получить ответ со статусом 200 и содержимым  `{"name": "имя трека", "artist": "имя композитора/группы"}`.
Поля `year` и `genres` в ответе не нужны.

#### 6. Метод просмотра всех треков со всей информацией
Url метода: `/api/v1/tracks/all`.
HTTP method: GET.

Для получения всей информации о всех треках необходимо сделать GET-запрос по данному урлу.
Пользователь получает ответ со статусом 200 и список полной информации о каждом треке вида `[TrackInfo1, TrackInfo2, TrackInfo3, ...]`.
Каждый `TrackInfo` содержит все поля (name, artist, year, genres) о треке, даже если они пусты.

#### 7. Метод поиска композиции
Url метода: `/api/v1/tracks/search`.
HTTP метод: GET.

Для поиска трека по имени (name) или исполнителю (artist) необходимо сделать GET-запрос по данному урлу. Параметры name и artist передаются в строке запроса (query).
Если пользователь не указал ни один из параметров, то он должен получить ответ со статусом 422 и содержимым `{"detail": "You should specify at least one search argument"}`.

**Важно:** Пользователь может указывать как один из параметров, так и оба. В таком случае поиск должен осуществляться с применением обоих условий.
